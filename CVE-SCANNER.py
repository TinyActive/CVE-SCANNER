import platform
import os

def get_linux_distribution():
    distro = None
    try:
        with open('/etc/os-release', 'r') as f:
            os_release = {}
            for line in f:
                # Skip lines that are comments or don't contain an '=' sign
                if '=' in line and not line.startswith('#'):
                    key, value = line.strip().split('=', 1)
                    os_release[key] = value.strip('"')
            distro = os_release.get('ID', '').lower()
    except FileNotFoundError:
        pass

    if not distro:
        try:
            # Fallback for older systems
            distro = platform.linux_distribution()[0].lower()
        except AttributeError:
            pass

    return distro

def run_os_specific_script():
    system = platform.system()
    if system == "Linux":
        distro = get_linux_distribution()
        if distro in ["debian", "ubuntu"]:
            os.system("python3 cve-scanner-debian.py --html")
        elif distro in ["redhat", "centos"]:
            os.system("python3 cve-scanner-redhat.py --html")
        else:
            print("Unsupported Linux distribution:", distro)
    else:
        print("Unsupported operating system:", system)

if __name__ == "__main__":
    run_os_specific_script()
